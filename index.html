<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Yeni YÄ±l KutlamasÄ±</title>
<style>
  body {
    margin: 0;
    background: linear-gradient(#0b1a33, #020611);
    overflow: hidden;
    color: white;
    font-family: Arial;
    text-align: center;
  }

  #snowCanvas, #fireCanvas {
    position: fixed;
    top: 0; left: 0;
    width: 100vw;
    height: 100vh;
    pointer-events: none;
  }

  .panel {
    position: fixed;
    top: 20px;
    width: 100%;
    text-align: center;
    z-index: 10;
  }

  .panel button {
    padding: 12px 20px;
    margin: 5px;
    font-size: 18px;
    border: none;
    border-radius: 8px;
    cursor: pointer;
  }

  #devInfo {
    margin-top: 120px;
    font-size: 16px;
    opacity: 0.7;
  }
</style>
</head>
<body>

<!-- â„ Kar ve ğŸ† Havai fiÅŸek -->
<canvas id="snowCanvas"></canvas>
<canvas id="fireCanvas"></canvas>

<!-- ğŸŸ¦ Ãœst Panel -->
<div class="panel">
  <button id="soundBtn">ğŸ”‡ Ses KapalÄ±</button>
  <button id="startBtn">ğŸ† KutlamayÄ± BaÅŸlat</button>

  <div id="devInfo">
    Bu sayfa: <b>Kemalettin Duyar</b> tarafÄ±ndan yapÄ±lmÄ±ÅŸtÄ±r.
  </div>
</div>

<script>
/* -------------------------
   ğŸ”µ Versiyon Kontrol (Gizli)
--------------------------*/
(function(){
  const version = "v5.0";
  if (localStorage.getItem("currentVersion") !== version) {
      localStorage.setItem("currentVersion", version);
      location.reload();
  }
})();

/* -------------------------
   â„ Kar Efekti
--------------------------*/
const snow = document.getElementById("snowCanvas");
const sctx = snow.getContext("2d");
snow.width = innerWidth;
snow.height = innerHeight;

let flakes = [];
for (let i = 0; i < 200; i++) {
  flakes.push({
    x: Math.random() * snow.width,
    y: Math.random() * snow.height,
    r: Math.random() * 3 + 1,
    d: Math.random() + 1
  });
}

function drawSnow() {
  sctx.clearRect(0, 0, snow.width, snow.height);
  sctx.fillStyle = "white";
  sctx.beginPath();
  for (let f of flakes) {
    sctx.moveTo(f.x, f.y);
    sctx.arc(f.x, f.y, f.r, 0, Math.PI * 2);
  }
  sctx.fill();
  updateSnow();
}

function updateSnow() {
  for (let f of flakes) {
    f.y += f.d;
    if (f.y > snow.height) f.y = 0;
  }
}
setInterval(drawSnow, 30);

/* -------------------------
   ğŸ† Havai FiÅŸek
--------------------------*/
const fire = document.getElementById("fireCanvas");
const fctx = fire.getContext("2d");
fire.width = innerWidth;
fire.height = innerHeight;

let fireworks = [];

function spawnFirework() {
  let x = Math.random() * fire.width;
  let y = fire.height + 10;
  let targetY = Math.random() * fire.height * 0.4 + 100;

  fireworks.push({
    x, y,
    targetY,
    particles: []
  });
}

function updateFireworks() {
  fctx.clearRect(0, 0, fire.width, fire.height);

  fireworks.forEach((fw, i) => {
    if (fw.y > fw.targetY) {
      fw.y -= 6;
    } else {
      if (fw.particles.length === 0) {
        for (let p = 0; p < 40; p++) {
          fw.particles.push({
            x: fw.x,
            y: fw.y,
            vx: (Math.random() - 0.5) * 6,
            vy: (Math.random() - 0.5) * 6,
            alpha: 1
          });
        }

        // ğŸ”Š TARAYICI Ä°Ã‡Ä° BEEP (garanti Ã§alÄ±ÅŸÄ±r)
        if (soundEnabled) playBeep();
      }

      fw.particles.forEach(p => {
        p.x += p.vx;
        p.y += p.vy;
        p.alpha -= 0.015;
      });

      fw.particles = fw.particles.filter(p => p.alpha > 0);
    }

    if (fw.particles.length === 0 && fw.y <= fw.targetY - 10) {
      fireworks.splice(i, 1);
    }
  });

  requestAnimationFrame(updateFireworks);
}
updateFireworks();

/* -------------------------
   ğŸ”Š Ses Fonksiyonu (BEÅÄ°KTAÅ GÄ°BÄ° GARANTÄ°)
--------------------------*/
function playBeep() {
  const ctx = new (window.AudioContext || window.webkitAudioContext)();
  const osc = ctx.createOscillator();
  osc.type = "square";
  osc.frequency.value = 300;
  osc.connect(ctx.destination);
  osc.start();
  setTimeout(() => osc.stop(), 150);
}

/* -------------------------
   ğŸŸ¢ Butonlar
--------------------------*/
let soundEnabled = false;

document.getElementById("soundBtn").onclick = () => {
  soundEnabled = !soundEnabled;

  document.getElementById("soundBtn").innerText =
    soundEnabled ? "ğŸ”Š Ses AÃ§Ä±k" : "ğŸ”‡ Ses KapalÄ±";

  // TarayÄ±cÄ±dan ilk ses izni
  if (soundEnabled) playBeep();
};

document.getElementById("startBtn").onclick = () => {
  setInterval(spawnFirework, 700);
};
</script>
</body>
</html>
