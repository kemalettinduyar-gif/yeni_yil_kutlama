<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Mutlu YÄ±llar</title>

  <!-- GÄ°ZLÄ° VERSÄ°YON KONTROLÃœ -->
  <script>
  (function(){
    document.addEventListener("DOMContentLoaded", () => {
      setTimeout(() => {
        try {
          const KEY = "page_v_final";
          const url = new URL(window.location.href);
          const v = url.searchParams.get("v");
          const saved = sessionStorage.getItem(KEY);
          if (!v || v !== saved) {
            const newV = Date.now().toString();
            sessionStorage.setItem(KEY, newV);
            const clean = window.location.origin + window.location.pathname;
            // window.location.href = clean + "?v=" + newV; 
            window.location.replace(clean + "?v=" + newV);

          }
        } catch(e){ }
      }, 400);
    });
  })();
  </script>

  <style>
    html,body{
      height:100%;
      margin:0;
      background: radial-gradient(ellipse at bottom, #0f1720 0%, #020307 80%);
      font-family: Arial, Helvetica, sans-serif;
      color: #fff;
      overflow: hidden;
    }

    #snowCanvas,#fireworksCanvas{
      position: fixed;
      left:0; top:0;
      width:100vw; height:100vh;
      pointer-events: none;
      z-index: 10;
    }

    .title{
      position: fixed; top:28px; width:100%; text-align:center; z-index:60;
    }

    h1{
      color:#ffd24c;
      margin:0;
      font-size:2.6rem;
      text-shadow:0 0 14px #000;
    }
    h2{
      margin:10px 0 0;
      font-size:1.35rem;
      opacity:.96;
      letter-spacing:1.3px;
      text-shadow:0 0 10px #000;
    }

    .panel{
      position: fixed;
      bottom: 110px;
      left: 50%;
      transform: translateX(-50%);
      display:flex;
      gap:10px;
      z-index:70;
    }
    .panel button{
      padding:10px 16px;
      border-radius:10px;
      border:none;
      cursor:pointer;
      background: rgba(255,255,255,0.12);
      color:#fff;
      backdrop-filter: blur(4px);
      border:1px solid rgba(255,255,255,0.14);
      font-size:15px;
    }

    .footer{
      position: fixed;
      bottom: 18px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0,0,0,0.45);
      padding: 8px 14px;
      border-radius: 8px;
      font-size:14px;
      z-index:70;
      white-space: nowrap;
    }

    /* GÄ°RÄ°Åž EKRANI */
    #inputScreen{
      position:fixed;
      inset:0;
      background:#020307;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      z-index:200;
      color:white;
      padding:20px;
    }
    #inputScreen h3{
      font-size:1.8rem;
      margin-bottom:20px;
    }
    #inputScreen input{
      width:260px;
      padding:10px;
      margin-top:12px;
      border-radius:8px;
      border:none;
      outline:none;
      font-size:16px;
      text-align:center;
    }
    #startMain{
      margin-top:20px;
      padding:12px 20px;
      border:none;
      border-radius:10px;
      background:#ffd24c;
      color:#000;
      font-size:17px;
      cursor:pointer;
      font-weight:bold;
    }
  </style>
</head>
<body>

<!-- ==================== GÄ°RÄ°Åž EKRANI ==================== -->
<div id="inputScreen">
  <h3>Yeni YÄ±l KutlamasÄ±na HoÅŸ Geldiniz ðŸŽ‰</h3>

  <input id="yearInput" type="number" placeholder="YÄ±l (Ã¶r: 2026)">
  <input id="groupInput" type="text" placeholder="Grup AdÄ± (Ã¶r: Emlak Grubu)">

  <button id="startMain">BaÅŸla</button>
</div>


<!-- ==================== ANA BAÅžLIK ==================== -->
<div class="title">
    <h1>Mutlu YÄ±llar <span id="yearText">2026</span> ðŸŽ†</h1>
    <h2>Mutlu YÄ±llar <span id="groupText">Emlak Grubu</span></h2>
</div>

<!-- Arka Plan AnimasyonlarÄ± -->
<canvas id="snowCanvas"></canvas>
<canvas id="fireworksCanvas"></canvas>

<!-- Kontrol Paneli -->
<div class="panel">
  <button id="soundBtn" aria-pressed="false">ðŸ”‡ Ses KapalÄ±</button>
  <button id="startBtn">ðŸŽ† KutlamayÄ± BaÅŸlat</button>
</div>

<div class="footer">Bu sayfa: Kemalettin Duyar tarafÄ±ndan hazÄ±rlanmÄ±ÅŸtÄ±r.</div>

<script>
/* ============================================================
    GÄ°RÄ°Åž EKRANI â€” DEÄžÄ°ÅžKENLERÄ° AL, ANA EKRANA AKTAR
============================================================ */
document.getElementById("startMain").onclick = () => {
    const yil = document.getElementById("yearInput").value;
    const grup = document.getElementById("groupInput").value;

    if(!yil || !grup){
        alert("LÃ¼tfen yÄ±l ve grup adÄ±nÄ± doldurunuz!");
        return;
    }

    document.getElementById("yearText").textContent = yil;
    document.getElementById("groupText").textContent = grup;

    document.getElementById("inputScreen").style.display = "none";
};

/* ============================================================
   CANVAS VE ANÄ°MASYON SÄ°STEMÄ°
============================================================ */
const snowCanvas = document.getElementById('snowCanvas');
const snowCtx = snowCanvas.getContext('2d');
const fwCanvas = document.getElementById('fireworksCanvas');
const fwCtx = fwCanvas.getContext('2d');

function resizeAll(){
  snowCanvas.width = window.innerWidth;
  snowCanvas.height = window.innerHeight;
  fwCanvas.width = window.innerWidth;
  fwCanvas.height = window.innerHeight;
}
window.addEventListener('resize', resizeAll);
resizeAll();

/* -------------------- KAR YAÄžIÅžI -------------------- */
let flakes = [];
function initFlakes(n=260){
  flakes = [];
  for(let i=0;i<n;i++){
    flakes.push({
      x: Math.random()*window.innerWidth,
      y: Math.random()*window.innerHeight,
      r: 1 + Math.random()*4,
      vx: (Math.random()-0.5)*0.6,
      vy: 1 + Math.random()*2
    });
  }
}
initFlakes();

function drawSnow(){
  snowCtx.clearRect(0,0,snowCanvas.width,snowCanvas.height);
  snowCtx.fillStyle = "rgba(255,255,255,0.95)";
  snowCtx.beginPath();
  for(const f of flakes){
    snowCtx.moveTo(f.x,f.y);
    snowCtx.arc(f.x,f.y,f.r,0,Math.PI*2);
  }
  snowCtx.fill();
  for(const f of flakes){
    f.x += f.vx + Math.sin(f.y/60)*0.35;
    f.y += f.vy;
    if(f.y > window.innerHeight+10){
      f.y = -10; f.x = Math.random()*window.innerWidth;
    }
    if(f.x < -20) f.x = window.innerWidth + 20;
    if(f.x > window.innerWidth + 20) f.x = -20;
  }
  requestAnimationFrame(drawSnow);
}
requestAnimationFrame(drawSnow);

/* -------------------- HAVAÄ° FÄ°ÅžEKLER -------------------- */
let rockets = [], particles = [], autoLaunch = null;

function launchRocket(){
  rockets.push({
    x: Math.random()*fwCanvas.width,
    y: fwCanvas.height + 10,
    targetY: 60 + Math.random()*(fwCanvas.height*0.45),
    speed: 6 + Math.random()*3
  });
}

function explode(x,y){
  const colors = ["#ff4d4d","#ffd11a","#66ff66","#66b3ff","#ff66cc","#ffffff"];
  const count = 45 + Math.floor(Math.random()*40);
  for(let i=0;i<count;i++){
    const ang = Math.random()*Math.PI*2;
    const speed = 1.5 + Math.random()*4.5;
    particles.push({
      x, y,
      vx: Math.cos(ang)*speed,
      vy: Math.sin(ang)*speed,
      age: 0,
      life: 60 + Math.random()*50,
      color: colors[Math.floor(Math.random()*colors.length)]
    });
  }

  if(soundEnabled) playExplosionSound();
}

function drawFW(){
  fwCtx.clearRect(0,0,fwCanvas.width,fwCanvas.height);

  for(let i=rockets.length-1;i>=0;i--){
    const r = rockets[i];
    r.y -= r.speed;
    fwCtx.fillStyle = "#fff";
    fwCtx.fillRect(r.x, r.y, 3, 8);

    if(r.y <= r.targetY){
      explode(r.x, r.y);
      rockets.splice(i,1);
    }
  }

  for(let i=particles.length-1;i>=0;i--){
    const p = particles[i];
    p.vy += 0.03;
    p.x += p.vx;
    p.y += p.vy;
    p.age++;
    const a = Math.max(0, 1 - p.age / p.life);
    fwCtx.fillStyle = `rgba(${p.color}, ${a})`;
    fwCtx.fillRect(p.x, p.y, 2, 2);
    if(p.age >= p.life) particles.splice(i,1);
  }

  requestAnimationFrame(drawFW);
}
requestAnimationFrame(drawFW);

function hexToRgba(hex, a){
  const c = hex.replace('#','');
  return `rgba(${parseInt(c.substr(0,2),16)},${parseInt(c.substr(2,2),16)},${parseInt(c.substr(4,2),16)},${a})`;
}

/* -------------------- SES SÄ°STEMÄ° -------------------- */
let audioCtx = null;
let soundEnabled = false;

function ensureAudioContext(){
  if(!audioCtx){
    audioCtx = new (window.AudioContext || window.webkitAudioContext)();
  } else if(audioCtx.state === 'suspended'){
    audioCtx.resume();
  }
}

function playExplosionSound(){
  ensureAudioContext();
  const ctx = audioCtx;
  const now = ctx.currentTime;

  const bufferSize = Math.floor(ctx.sampleRate * 0.38);
  const buffer = ctx.createBuffer(1, bufferSize, ctx.sampleRate);
  const data = buffer.getChannelData(0);

  for(let i=0;i<bufferSize;i++){
    data[i] = (Math.random()*2-1) * Math.pow(1 - i/bufferSize, 3);
  }

  const noise = ctx.createBufferSource();
  noise.buffer = buffer;

  const bandpass = ctx.createBiquadFilter();
  bandpass.type = 'bandpass';
  bandpass.frequency.value = 1400 + Math.random()*600;

  const gain = ctx.createGain();
  gain.gain.setValueAtTime(0.7, now);
  gain.gain.exponentialRampToValueAtTime(0.001, now + 0.45);

  noise.connect(bandpass);
  bandpass.connect(gain);
  gain.connect(ctx.destination);

  noise.start(now);
  noise.stop(now+0.45);
}

/* -------------------- BUTONLAR -------------------- */
document.getElementById('soundBtn').onclick = () => {
  ensureAudioContext();
  soundEnabled = !soundEnabled;
  soundBtn.textContent = soundEnabled ? "ðŸ”Š Ses AÃ§Ä±k" : "ðŸ”‡ Ses KapalÄ±";
};

document.getElementById('startBtn').onclick = () => {
  ensureAudioContext();
  if(!autoLaunch){
    autoLaunch = setInterval(launchRocket, 650);
  }
  launchRocket();
  launchRocket();
};
</script>
</body>
</html>
